<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.19.1/cdn/themes/light.css" />

  <div id="catalog-container" class="container">
    <!-- Shoelace Tab Group -->
    <sl-tab-group id="tabs">
      
    </sl-tab-group>
  </div>

  <style>
    .card-overview {
      max-width: 300px;
      display: inline-block;
      margin: 10px;
    }

    .card-overview small {
      color: var(--sl-color-neutral-500);
    }

    .card-overview [slot='footer'] {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      width: 100%;
      min-width: 350px;
      display: flex;
      justify-content: center;
      flex-direction: column;
      align-items: center;
    }
    
    #tabs {
      width: 100%;
    }
    #tabs::part(tabs) {
      justify-content: center;
    }
    #tabs::part(active-tab-indicator) {
      display: none;
    }
    

    .card-container {
      display: flex;
      flex-wrap: wrap; /* Allows cards to wrap to the next line */
      justify-content: center; /* Centers cards horizontally */
      gap: 10px; /* Spacing between cards */
    }

    .pagination-container {
      display: block;
      margin-top: 20px;
      text-align: center;
    }

    .pagination {
      display: flex;
      justify-content: center;
      gap: 10px;
    }

    .card-page {
      display: none;
    }

    .card-page.active {
      display: block;
    }
    /* Styles for the pagination bullets */
    .pagination-bullets {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 10px; /* Adjusted margin */
    }

    .pagination-bullet {
      width: 12px;
      height: 12px;
      background-color: #ccc;
      border-radius: 50%;
      cursor: pointer;
    }

    .pagination-bullet.active {
      background-color: #007bff;
    }

    /* Ensures the pagination buttons are evenly spaced and look centered */
    sl-button {
      margin: 20px 10px;
    }
  </style>

  <script>
    // This is how many elements show per page
    const cardsPerPage = 3;

    // This is where we add new data.
    const catalogData = [
    {
      group: {
        title: "Header One",
        panelName: "group0",
        cards: [
          {
            image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
            title: "Barth",
            description: "This kitten is as small as he is playful. Bring him home today!",
            price: "6 weeks old"
          },
          {
            image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
            title: "Mittens",
            description: "This kitten is as small as he is playful. Bring him home today!",
            price: "6 weeks old"
          },
          {
            image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
            title: "Mittens",
            description: "This kitten is as small as he is playful. Bring him home today!",
            price: "6 weeks old"
          },
          {
            image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
            title: "Mittens",
            description: "This kitten is as small as he is playful. Bring him home today!",
            price: "6 weeks old"
          }
        ]
      }
    },
    {
      group: {
        title: "Header Two",
        panelName: "group1",
        cards: [
          {
            image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
            title: "Barth",
            description: "This kitten is as small as he is playful. Bring him home today!",
            price: "6 weeks old"
          },
          {
            image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
            title: "Mittens",
            description: "This kitten is as small as he is playful. Bring him home today!",
            price: "6 weeks old"
          },
          {
            image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
            title: "Mittens",
            description: "This kitten is as small as he is playful. Bring him home today!",
            price: "6 weeks old"
          },
          {
            image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
            title: "Mittens",
            description: "This kitten is as small as he is playful. Bring him home today!",
            price: "6 weeks old"
          }
        ]
      }
    },
    {
      group: {
        title: "Header Three",
        panelName: "group2",
        cards: [
        {
          image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
          title: "Barth",
          description: "This kitten is as small as he is playful. Bring him home today!",
          price: "6 weeks old"
        },
        {
          image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
          title: "Mittens",
          description: "This kitten is as small as he is playful. Bring him home today!",
          price: "6 weeks old"
        },
        {
          image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
          title: "Mittens",
          description: "This kitten is as small as he is playful. Bring him home today!",
          price: "6 weeks old"
        },
        {
          image: "https://images.unsplash.com/photo-1559209172-0ff8f6d49ff7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80",
          title: "Mittens",
          description: "This kitten is as small as he is playful. Bring him home today!",
          price: "6 weeks old"
        }
        ]
      }
    }
  ];
  async function generateCatalogStructure(data) {
    const tabGroup = document.getElementById('tabs'); // Get the tab group container
  
    data.forEach(item => {
      const group = item.group;
  
      // Create the tab
      const tab = document.createElement('sl-tab');
      tab.setAttribute('slot', 'nav');
      tab.setAttribute('panel', group.panelName);
      tab.textContent = group.title;
      tabGroup.appendChild(tab);
  
      // Create the tab panel
      const tabPanel = document.createElement('sl-tab-panel');
      tabPanel.setAttribute('name', group.panelName);
  
      // Create the card container for the group
      const cardContainer = document.createElement('div');
      cardContainer.classList.add('card-container');
  
      // Create the cards inside each panel
      group.cards.forEach(card => {
        const cardElement = document.createElement('sl-card');
        cardElement.classList.add('card-overview');
  
        if (card.image) {
          const img = document.createElement('img');
          img.setAttribute('slot', 'image');
          img.setAttribute('src', card.image);
          img.setAttribute('alt', card.title);
          cardElement.appendChild(img);
        }
  
        const title = document.createElement('strong');
        title.textContent = card.title;
        cardElement.appendChild(title);
  
        if (card.description) {
          const description = document.createElement('p');
          description.textContent = card.description;
          cardElement.appendChild(description);
        }
  
        if (card.age) {
          const age = document.createElement('small');
          age.textContent = card.age;
          cardElement.appendChild(age);
        }
  
        const footer = document.createElement('div');
        footer.setAttribute('slot', 'footer');
        const button = document.createElement('sl-button');
        button.setAttribute('variant', 'primary');
        button.setAttribute('pill', true);
        button.textContent = 'More Info';
        footer.appendChild(button);
        cardElement.appendChild(footer);
  
        cardContainer.appendChild(cardElement);
      });

      const paginationContainer = document.createElement('div');
        paginationContainer.classList.add('pagination-container');
        tabPanel.appendChild(paginationContainer);

      // Append the card container to the tab panel
      tabPanel.appendChild(cardContainer);
  
      // Append the tab panel to the tab group
      tabGroup.appendChild(tabPanel);
    });
  }    

  async function initPagination() {
    const tabPanels = document.querySelectorAll('sl-tab-panel');
    tabPanels.forEach((tabPanel) => {
      const cards = tabPanel.querySelectorAll('.card-overview');
      const totalCards = cards.length;

      if (totalCards > cardsPerPage) {
        const pages = Math.ceil(totalCards / cardsPerPage);
        const paginationContainer = tabPanel.querySelector('.pagination-container');
        
        // Create page containers
        for (let i = 0; i < pages; i++) {
          const page = document.createElement('div');
          page.classList.add('card-page');
          paginationContainer.appendChild(page);
          const start = i * cardsPerPage;
          const end = start + cardsPerPage;

          cards.forEach((card, index) => {
            if (index >= start && index < end) {
              page.appendChild(card);
            }
          });
        }

        // Add next/previous buttons
        const prevButton = document.createElement('sl-button');
        prevButton.textContent = 'Previous';
        prevButton.variant = 'default';
        paginationContainer.appendChild(prevButton);

        const nextButton = document.createElement('sl-button');
        nextButton.textContent = 'Next';
        nextButton.variant = 'default';
        paginationContainer.appendChild(nextButton);

        // Create page bullets below the buttons
        const bulletsContainer = document.createElement('div');
        bulletsContainer.classList.add('pagination-bullets');
        paginationContainer.appendChild(bulletsContainer);

        for (let i = 0; i < pages; i++) {
          const bullet = document.createElement('span');
          bullet.classList.add('pagination-bullet');
          bulletsContainer.appendChild(bullet);
        }

        let currentPage = 0;
        function updatePage() {
          const pages = tabPanel.querySelectorAll('.card-page');
          const bullets = tabPanel.querySelectorAll('.pagination-bullet');
          
          pages.forEach((page, index) => {
            page.classList.remove('active');
            if (index === currentPage) {
              page.classList.add('active');
            }
          });

          bullets.forEach((bullet, index) => {
            bullet.classList.remove('active');
            if (index === currentPage) {
              bullet.classList.add('active');
            }
          });
        }

        prevButton.addEventListener('click', () => {
          if (currentPage > 0) {
            currentPage--;
            updatePage();
          }
        });

        nextButton.addEventListener('click', () => {
          const pages = tabPanel.querySelectorAll('.card-page');
          if (currentPage < pages.length - 1) {
            currentPage++;
            updatePage();
          }
        });

        // Add click event for page bullets
        const bullets = tabPanel.querySelectorAll('.pagination-bullet');
        bullets.forEach((bullet, index) => {
          bullet.addEventListener('click', () => {
            currentPage = index;
            updatePage();
          });
        });

        updatePage();
      } else {
        // If there are 3 or fewer cards, don't add pagination
        cards.forEach(card => {
          tabPanel.querySelector('.card-container').appendChild(card);
        });
      }
    });
  }

  // Inject Shoelace
  async function injectShoelace() {
    const script = document.createElement('script');
    script.type = 'module'; 
    script.src = 'https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.19.1/cdn/shoelace-autoloader.js';
    document.body.appendChild(script);
  }

  // The function that makes everything go
  document.addEventListener('DOMContentLoaded', async function() {
    await generateCatalogStructure(catalogData)
    await initPagination()
    injectShoelace()
  });
</script>
</body>
</html>